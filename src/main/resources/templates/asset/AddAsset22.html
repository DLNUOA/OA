<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>增删改查Asset</title>
    <script src="./js/jquery.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/vue.js"></script>
    <script src="./js/axios.js"></script>
    <script src="./js/common.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.13.1/lodash.min.js"></script>
    <script src="./js/bootstrap.js" type="text/javascript" charset="utf-8"></script>
    <link rel="stylesheet" href="./css/bootstrap.css">
</head>
<body>
<table class="table table-hover " id='assetInfoList'>
    <caption><h1 align="center">资产管理</h1></caption>
    <thead>
    <tr>
        <th>资产ID</th>
        <th>资产名称</th>
        <th>资产类别</th>
        <th>资产规格</th>
        <th>资产单价</th>
        <th>资产库存</th>
        <th>操作</th>
    </tr>
    </thead>

    <tbody >
    <!-- 以后写vue循环时候推荐下面这样写，v-bind:key = 'dept.deptId'这句一定不能漏掉然后{{这里面只能使用一个表达式}} -->
    <tr  v-for="(asset,index) of assets>
        <td>{{index+1}}</td>
        <td>{{asset.assetId}}</td>
        <td>{{asset.assetName}}</td>
        <td>{{asset.assetClasses}}</td>
        <td>{{asset.assetSpecification}}</td>
        <td>{{asset.assetUnitPrice}}</td>
        <td>{{asset.assetInventory}}</td>
        <td>
            <!-- 按钮触发模态框 -->
            <button class="btn btn-primary " data-toggle="modal" data-target="#updateAssetModal" @click="LaunchUpdateAsset(index)">修改</button>

            <a @click="deleteAsset(index)" class="btn btn-danger">删除</a>
        </td>
    </tr>

    </tbody>
</table>
<button class="btn btn-success " data-toggle="modal" data-target="#addAssetModal">增加资产</button>
<!-- 增加资产模态框（Modal） -->
<div class="modal fade" id="addAssetModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content" id="addAsset">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabelAdd">增加资产</h4>
            </div>
            <div class="modal-body" >
                资产名称：<input v-model="bmm" placeholder="资产名称"><hr>
                资产类别：<input v-model="bml" placeholder="资产类别"><hr>
                资产规格：<input v-model="bmg" placeholder="资产规格">
                资产单价：<input v-model="bmd" placeholder="资产单价"><hr>
                资产库存：<input v-model="bmk" placeholder="资产库存"><hr>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-primary" @click="addAAsset">增加</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>


<!-- 修改部门模态框（Modal） -->
<div class="modal fade" id="updateAssetModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content"  id="updateAAssetModal">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">修改资产</h4>
            </div>
            <div class="modal-body" >
                资产名称：<input v-model="assetName" placeholder="资产名称"><hr>
                资产类别：<input v-model="assetClasses" placeholder="资产类别"><hr>
                资产规格：<input v-model="assetSpecification" placeholder="资产规格">
                资产单价：<input v-model="assetUnitPrice" placeholder="资产单价"><hr>
                资产库存：<input v-model="assetInventory" placeholder="资产库存"><hr>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-primary" @click="updateAAsset">修改</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>


<script src="/js/bootstrap.js" type="text/javascript" charset="utf-8"></script>
<script src="/Vue/js/axios.js"></script>
<script src="/Vue/js/lodash.min.js"></script>
<script type="text/javascript">

<script type = "text/javascript">


    var addDept = new Vue({
        el:'#addAsset',
        data:{
            bmm:'',
            bml:'',
            bmg:'',
            bmd:'',
            bmk:''
        },
        methods:{
            addAAsset:function (){
                axios
                    .post('/api/asset/add',{
                        assetName:this.bmm,
                        assetClasses:this.bml,
                        assetSpecification:this.bmg,
                        assetUnitPrice:this.bmd,
                        assetInventory:this.bmk
                    })
                    .then( response => response.data ==1 ? ( alert('增加资产成功') ) : ( alert('增加资产失败，请联系管理员') ) )
                    .catch(function(error) {
                        console.log(error);
                    });
            }
        }
    });

    var updateAAssetModal = new Vue({
        el:'#updateAAssetModal',
        data:{
            assetId:null,
            assetName:null,
            assetClasses:null,
            assetSpecification:null,
            assetUnitPrice:null,
            assetInventory:null
        },
        methods:{
            updateAAsset:function(){
                axios
                    .post('/api/asset/query',{
                        // 回显
                        assetId:this.assetId,
                        assetName:this.bmm,
                        assetClasses:this.bml,
                        assetSpecification:this.bmg,
                        assetUnitPrice:this.bmd,
                        assetInventory:this.bmk

                    })
                    .then( response => response.data ==1 ? ( alert('修改资产成功') ) : ( alert('修改资产失败，请联系管理员') ) )
                    .catch(function(error) {
                        console.log(error);
                    });
            }
        }
    });


    var AssetList = new Vue({
        el: '#assetInfoList',
        // 不使用return包裹的数据会在项目的全局可见，会造成变量污染；使用return包裹后数据中变量只在当前组件中生效，不会影响其他组件。
        data () {
            return {
                assets: null,
                asset:null
            }
        },
        methods: {
            deleteAsset: function (index) {
                //使用let定义局部变量
                let AssetId = this.assets[index].assetId;
                if(confirm('确定删除该部门吗？部门id为'+assetId)){
                    this.assets.splice(index,1);
                    axios
                        .delete('/api/asset/delete/'+assetId)
                        .then(response => response.data==1?(alert('删除成功')):alert('删除失败'))
                        .catch(function(error){
                            console.log(errot);
                        });
                }
            },
            getAssets:function(){
                axios
                    .get('/api/asset/query')
                    .then(response => console.log(response.data))
                    .catch(function(error) {
                        console.log(error);
                    });
            },
            LaunchUpdateAsset:function(index){
                this.asset=(this.assets[index]);
                updateAAssetModal.assetId = this.asset.assetId;
                updateAAssetModal.assetName = this.asset.assetName;
                updateAAssetModal.assetClasses = this.asset.assetClasses;
                updateAAssetModal.assetSpecification = this.asset.assetSpecification;
                updateAAssetModal.assetUnitPrice = this.asset.assetUnitPrice;
                updateAAssetModal.assetInventory = this.asset.assetInventory;

            }
        },
        mounted () {
            //当Vue实例挂载完成时，自动调用后端接口获取所有dept数据并且将数据渲染到html
            axios
                .get('/api/asset/query')
                .then(response => (this.depts = response.data))
                .catch(function (error) { // 请求失败处理
                    console.log(error);
                });
        }
    });








    var deptList = new Vue({
        el: '#assetInfoList',
        // 不使用return包裹的数据会在项目的全局可见，会造成变量污染；使用return包裹后数据中变量只在当前组件中生效，不会影响其他组件。
        data () {
            return {
                assets: null,
                asset:null
            }
        },
        methods: {
            // deleteDept: function (index) {
            //     //使用let定义局部变量
            //     let deptId = this.depts[index].deptId;
            //     if(confirm('确定删除该部门吗？部门id为'+deptId)){
            //         this.depts.splice(index,1);
            //         axios
            //             .delete(host+'/api/dept/'+deptId)
            //             .then(response => response.data==1?(alert('删除成功')):alert('删除失败'))
            //             .catch(function(error){
            //                 console.log(errot);
            //             });
            //     }
            // },
            getDepts:function(){
                axios
                    .post('/api/asset/query')
                    .then(response => console.log(response.data))
                    .catch(function(error) {
                        console.log(error);
                    });
            },
            // LaunchUpdateDept:function(index){
            //     this.dept=(this.depts[index]);
            //     updateADeptModal.deptId = this.dept.deptId;
            //     updateADeptModal.deptName = this.dept.deptName;
            //     updateADeptModal.deptLoc = this.dept.deptLoc;
            //     updateADeptModal.deptIntro = this.dept.deptIntro;
            // }
        },
        mounted () {
            //当Vue实例挂载完成时，自动调用后端接口获取所有dept数据并且将数据渲染到html
            axios
                .post('/api/asset/query')
                .then(response => (this.depts = response.data))
                .catch(function (error) { // 请求失败处理
                    console.log(error);
                });
        }
    });




</script>









































    </body>
</html>